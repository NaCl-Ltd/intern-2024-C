<li id='micropost-<%= micropost.id %>'>
  <%= link_to gravatar_for(micropost.user, size: 50), micropost.user %>
  <span class='user'>
    <%= link_to micropost.user.name, micropost.user %>
  </span>

  <span class='content'>
    <%= raw linkify_nickname(
              Rinku.auto_link(micropost.content),
              @micropost_matching_nicknames,
              user_path(@user || current_user)
    ) %>
    <% if micropost.images.attached? %>
      <% micropost.images.each do |image| %>
        <%= image_tag image.variant(:display) %>
      <% end %>
    <% end %>
  </span>

  <span class='timestamp'>
    Posted <%= time_ago_in_words(micropost.created_at) %> ago.
    <%= render 'microposts/like_btn', micropost: micropost %>

    <% if logged_in? && (micropost.user_id == current_user.id || current_user.admin?) %>
      <%= link_to 'delete', micropost, data: {
        turbo_method: :delete,
        turbo_confirm: 'Are you sure you want to delete this post?'
      } %>

      <% if action_name == 'trash' %>
        <%= link_to 'restore', micropost, data: { turbo_method: :patch } %>
      <% elsif micropost.user_id == current_user.id %>
        <%= link_to micropost.pinned? ? 'unpin' : 'pin',
                    toggle_pinned_micropost_path(micropost),
                    data: { turbo_method: :patch } %>
      <% end %>
    <% end %>
  </span>
</li>
